(window.MIP=window.MIP||[]).push({name:"mip-semi-fixed",func:function(){define("mip-semi-fixed/mip-semi-fixed",["require","util","viewport","customElement","fixed-element","viewer"],function(e){function t(e){var t=this.element,i=this.container,o=this.threshold,r=this.fixedClassNames;if(n.rect.getElementOffset(t).top<=o){if(i.className.indexOf(r)<0)i.className+=r;i.setAttribute(l.STATUS_FIXED,""),n.css(i,"top",o+"px")}else i.className=i.className.replace(r,""),i.removeAttribute(l.STATUS_FIXED),n.css(i,"top","")}function i(e){var t=this.element;if(n.rect.getElementOffset(t).top<=this.threshold)n.css(this.fixedContainer.parentNode,{display:"block"}),n.css(this.fixedContainer,{opacity:1}),n.css(this.container,{opacity:0});else n.css(this.fixedContainer.parentNode,{display:"none"}),n.css(this.fixedContainer,{opacity:0}),n.css(this.container,{opacity:1})}var n=e("util"),o=e("viewport"),r=e("customElement").create(),a=e("fixed-element"),s=e("viewer"),l={STATUS_FIXED:"mip-semi-fixed-fixedStatus",STATUS_SCROLL:"mip-semi-fixed-scrollStatus"};return r.prototype.build=function(){var e=this,r=e.element;if(offsetTop=n.rect.getElementOffset(r).top,!a||!a._fixedLayer||r.parentNode!==a._fixedLayer){if(e.container=r.querySelector("div[mip-semi-fixed-container]"),!e.container)return void console.error("必须有 <div mip-semi-fixed-container> 子节点");if(e.threshold=r.getAttribute("threshold")||0,e.fixedClassNames=" "+r.getAttribute("fixedClassNames"),e.container.setAttribute(l.STATUS_SCROLL,""),s.isIframed&&n.platform.isIos()){try{var c=a._fixedLayer.querySelector("#"+r.id);e.fixedContainer=c.querySelector("div[mip-semi-fixed-container]"),e.fixedContainer.className+=e.fixedClassNames,e.fixedContainer.setAttribute(l.STATUS_FIXED,""),e.fixedContainer.removeAttribute(l.STATUS_SCROLL),n.css(e.fixedContainer,{top:e.threshold+"px",opacity:0})}catch(e){console.error(e)}o.on("scroll",function(){i.call(e,o)}),document.body.addEventListener("touchmove",function(t){i.call(e,o)}),i.call(e,o)}else o.on("scroll",function(){t.call(e,o)}),document.body.addEventListener("touchmove",function(i){t.call(e,o)}),t.call(e,o);if(!n.platform.isIos()&&offsetTop<=e.threshold){if(e.container.className.indexOf(e.fixedClassNames)<0)e.container.className+=e.fixedClassNames;e.container.setAttribute(l.STATUS_FIXED,""),n.css(e.container,"top",e.threshold+"px")}else if(n.platform.isIos()&&s.isIframed&&offsetTop<=e.threshold)n.css(this.fixedContainer.parentNode,{display:"block"}),n.css(this.fixedContainer,{opacity:1}),n.css(this.container,{opacity:0});e.addEventAction("close",function(t){if(t.preventDefault(),n.css(r,{display:"none"}),s.isIframed)n.css(e.fixedContainer,{display:"none"})})}},r}),define("mip-semi-fixed",["mip-semi-fixed/mip-semi-fixed"],function(e){return e}),function(){function e(e,t){e.registerMipElement("mip-semi-fixed",t,"mip-semi-fixed{position:relative;width:100%}.mip-fixedlayer div[mip-semi-fixed-scrollStatus],mip-semi-fixed div[mip-semi-fixed-scrollStatus]{position:absolute;z-index:1;width:100%;-webkit-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}.mip-fixedlayer mip-semi-fixed{position:fixed !important;width:100%}.mip-fixedlayer div[mip-semi-fixed-fixedStatus],mip-semi-fixed div[mip-semi-fixed-fixedStatus]{position:fixed;width:100%;z-index:999}")}if(window.MIP)require(["mip-semi-fixed"],function(t){e(window.MIP,t)});else require(["mip","mip-semi-fixed"],e)}()}});